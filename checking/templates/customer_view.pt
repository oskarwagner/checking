<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="layout">
  <head>
    <metal:title fill-slot="title">${context.title} â€” Customers</metal:title>
  </head>
  <body>
    <metal:content fill-slot="content">
      <h1>${context.title}</h1>

      <dl class="grid">
        <tal:block condition="context.ein">
          <dt>EIN</dt>
          <dd>${context.ein}</dd>
        </tal:block>
        <tal:block condition="context.address">
          <dt>Address</dt>
          <dd><address>
            ${context.address}
            ${context.postal_code} ${context.city}
            ${context.country}
          </address>
          </dd>
        </tal:block>
        <tal:block condition="context.contact_name">
          <dt>Contact</dt>
          <dd>${context.contact_name}
            <tal:span condition="context.contact_email"><br/><a href="mailto:${context.contact_email}">${context.contact_email}</a></tal:span>
            <tal:span condition="context.contact_phone"><br/>${context.contact_phone}</tal:span>
          </dd>
        </tal:block>
      </dl>

      <h2>Invoices</h2>

      <p tal:condition="not invoices">
        There are no invoices for this customer.
      </p>

      <table tal:condition="invoices">
        <thead>
          <tr>
            <th>Number</th>
            <th>Amount</th>
            <th>Sent on</th>
            <th>Paid on</th>
          </tr>
        </thead>
        <tbody>
          <tr tal:repeat="invoice invoices">
            <td><a href="${invoice.url}"><tal:span condition="invoice.number">${invoice.number}</tal:span><tal:span condition="not invoice.number">Pending</tal:span></a></td>
            <td>${formatter.decimal(invoice.amount)}</td>
            <td><tal:span condition="invoice.sent">${formatter.date(invoice.sent)}</tal:span><tal:span condition="not invoice.sent">Unsent</tal:span></td>
            <td><tal:span condition="invoice.paid">${formatter.date(invoice.paid)}</tal:span><tal:span condition="not invoice.paid">Unpaid</tal:span></td>
          </tr>
        </tbody>
      </table>
    </metal:content>
    <metal:portlets fill-slot="portlets">
      <div id="portlets">
        <div class="portlet contextual">
          <h3>Actions</h3>
          <div class="portletContent">
            <ul>
              <li tal:condition="permission:edit"><a href="${tools.route_url('customer_edit', id=context.id)}">Modify</a></li>
              <li tal:condition="permission:add-invoice"><a href="${tools.route_url('customer_add_invoice', id=context.id)}">New invoice</a></li>
            </ul>
          </div>
        </div>
      </div>
    </metal:portlets>
  </body>
</html>

